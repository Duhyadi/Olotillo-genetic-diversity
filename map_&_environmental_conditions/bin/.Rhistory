values = c(
"Dzit-bacal" = "purple",
"Mix" = "green",
"Olotillo" = "blue",
"Tuxpe√±o" = "gold"
)
) +
# 6Ô∏è‚É£ Estilo visual
theme_void() +
theme(
legend.position = c(0.85, 0.35),   # leyenda dentro del mapa
legend.title = element_text(size = 10, face = "bold"),
legend.text = element_text(size = 9),
legend.background = element_rect(fill = "white", color = "grey80"),
plot.margin = margin(10, 10, 10, 10)
) +
guides(
shape = guide_legend(title = "Race", override.aes = list(size = 3)),
color = guide_legend(title = "Race", override.aes = list(size = 3))
)
# Mostrar mapa
map3b
# --- MAPA FINAL: Solo leyenda de Race ----------------------------------------
map3b <- ggplot() +
# 1Ô∏è‚É£ Capa base (M√©xico)
geom_sf(
data = mexico_sf,
aes(fill = ENTIDAD),    # para colorear, pero SIN leyenda
colour = "grey60",
linewidth = 0.25,
show.legend = FALSE     # üö´ esto evita que genere esa leyenda gigante
) +
scale_fill_manual(
values = c(
"CAMPECHE" = "#c69c39",
"CHIAPAS" = "#6780d8",
"GUERRERO" = "#b94656",
"OAXACA" = "#52bd85",
"QUINTANA ROO" = "#36dee6",
"SAN LUIS POTOSI" = "#89863c",
"VERACRUZ DE IGNACIO DE LA LLAVE" = "#75a842",
"NAYARIT" = "#b6b638",
"HIDALGO" = "#b94656"
),
na.value = "white",
guide = "none"           # üö´ oculta la leyenda del fill
) +
# 2Ô∏è‚É£ Capa PGMN
geom_point(
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
colour = "black",
size = 0.7
) +
# 3Ô∏è‚É£ Puntos de razas
geom_point(
data = olotillo.points,
aes(x = longitude, y = latitude, shape = Race, color = Race),
size = 1.8,
stroke = 0.7
) +
# 4Ô∏è‚É£ Escalas de raza (solo estas con leyenda)
scale_shape_manual(
values = c(
"Dzit-bacal" = 15,
"Mix" = 17,
"Olotillo" = 16,
"Tuxpe√±o" = 18
)
) +
scale_color_manual(
values = c(
"Dzit-bacal" = "purple",
"Mix" = "green",
"Olotillo" = "blue",
"Tuxpe√±o" = "gold"
)
) +
# 5Ô∏è‚É£ Estilo visual
theme_void() +
theme(
legend.position = c(0.85, 0.35),
legend.title = element_text(size = 10, face = "bold"),
legend.text = element_text(size = 9),
legend.background = element_rect(fill = "white", color = "grey80")
) +
guides(
shape = guide_legend(title = "Race", override.aes = list(size = 3)),
color = guide_legend(title = "Race", override.aes = list(size = 3))
)
map3b
# --- MAPA FINAL LIMPIO CON LEYENDA DE RAZAS ----------------------------------
# Asegurar que ENTIDAD sea texto plano (evita regenerar leyenda)
mexico_sf$ENTIDAD <- as.character(mexico_sf$ENTIDAD)
map3b <- ggplot() +
# --- 1Ô∏è‚É£ Capa base (M√©xico, sin leyenda)
geom_sf(
data = mexico_sf,
aes(fill = ENTIDAD),
colour = "grey60",
linewidth = 0.25,
show.legend = FALSE      # üö´ evita leyenda del fill
) +
# --- 2Ô∏è‚É£ Capa de distribuci√≥n (opcional)
geom_sf(
data = distribution,
colour = "black",
fill = NA,
linewidth = 0.3,
show.legend = FALSE
) +
# --- 3Ô∏è‚É£ Puntos de PGMN
geom_point(
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
colour = "black",
size = 0.6
) +
# --- 4Ô∏è‚É£ Puntos de razas
geom_point(
data = olotillo.points,
aes(x = longitude, y = latitude, shape = Race, color = Race),
size = 1.8,
stroke = 0.8
) +
# --- 5Ô∏è‚É£ Escalas de raza
scale_shape_manual(
name = "Race",  # asegura que se muestre en leyenda
values = c(
"Dzit-bacal" = 15,  # cuadrado
"Mix" = 17,         # tri√°ngulo
"Olotillo" = 16,    # c√≠rculo
"Tuxpe√±o" = 18      # rombo
)
) +
scale_color_manual(
name = "Race",  # asegura coherencia con shape
values = c(
"Dzit-bacal" = "purple",
"Mix" = "green",
"Olotillo" = "blue",
"Tuxpe√±o" = "gold"
)
) +
# --- 6Ô∏è‚É£ Estilo general
theme_void() +
theme(
legend.position = c(0.85, 0.35),
legend.title = element_text(size = 10, face = "bold"),
legend.text = element_text(size = 9),
legend.background = element_rect(fill = "white", color = "grey80"),
plot.margin = margin(10, 10, 10, 10)
) +
guides(
shape = guide_legend(title = "Race", override.aes = list(size = 3)),
color = guide_legend(title = "Race", override.aes = list(size = 3))
)
# Mostrar mapa
map3b
# --- Mapa final limpio con leyenda de "Race" ---------------------------------
# Asegurarse que ENTIDAD sea texto
mexico_sf$ENTIDAD <- as.character(mexico_sf$ENTIDAD)
# Crear una lista de estados muestreados
sampled.states <- c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO",
"SAN LUIS POTOSI", "VERACRUZ DE IGNACIO DE LA LLAVE")
# Crear un campo nuevo para los colores base
mexico_sf$color_fill <- ifelse(mexico_sf$ENTIDAD %in% sampled.states, "grey70", "white")
# --- Mapa
map3b <- ggplot() +
# 1Ô∏è‚É£ Pol√≠gonos base (sin aes, sin leyenda)
geom_sf(
data = mexico_sf,
fill = mexico_sf$color_fill,   # color fijo, no en aes()
colour = "grey50",
linewidth = 0.25
) +
# 2Ô∏è‚É£ Capa de distribuci√≥n (opcional)
geom_sf(
data = distribution,
colour = "black",
fill = NA,
linewidth = 0.3
) +
# 3Ô∏è‚É£ Puntos PGMN
geom_point(
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
colour = "black",
size = 0.6
) +
# 4Ô∏è‚É£ Puntos de razas
geom_point(
data = olotillo.points,
aes(x = longitude, y = latitude, shape = Race, color = Race),
size = 1.8,
stroke = 0.8
) +
# 5Ô∏è‚É£ Escalas de raza
scale_shape_manual(
name = "Race",
values = c(
"Dzit-bacal" = 15,
"Mix" = 17,
"Olotillo" = 16,
"Tuxpe√±o" = 18
)
) +
scale_color_manual(
name = "Race",
values = c(
"Dzit-bacal" = "purple",
"Mix" = "green",
"Olotillo" = "blue",
"Tuxpe√±o" = "gold"
)
) +
# 6Ô∏è‚É£ Estilo visual limpio
theme_void() +
theme(
legend.position = c(0.85, 0.35),  # dentro del mapa
legend.title = element_text(size = 10, face = "bold"),
legend.text = element_text(size = 9),
legend.background = element_rect(fill = "white", color = "grey80"),
plot.margin = margin(10, 10, 10, 10)
) +
guides(
shape = guide_legend(title = "Race", override.aes = list(size = 3)),
color = guide_legend(title = "Race", override.aes = list(size = 3))
)
# Mostrar mapa
map3b
# --- Mapa final limpio con leyenda de "Race" ---------------------------------
# Asegurarse que ENTIDAD sea texto
mexico_sf$ENTIDAD <- as.character(mexico_sf$ENTIDAD)
# Crear una lista de estados muestreados
sampled.states <- c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO",
"SAN LUIS POTOSI", "VERACRUZ DE IGNACIO DE LA LLAVE")
# Crear un campo nuevo para los colores base
mexico_sf$color_fill <- ifelse(mexico_sf$ENTIDAD %in% sampled.states, "grey70", "white")
# --- Mapa
map3b <- ggplot() +
# 1Ô∏è‚É£ Pol√≠gonos base (sin aes, sin leyenda)
geom_sf(
data = mexico_sf,
fill = mexico_sf$color_fill,   # color fijo, no en aes()
colour = "grey50",
linewidth = 0.25
) +
# 2Ô∏è‚É£ Capa de distribuci√≥n (opcional)
geom_sf(
data = distribution,
colour = "black",
fill = NA,
linewidth = 0.3
) +
# 3Ô∏è‚É£ Puntos PGMN
geom_point(
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
colour = "black",
size = 0.6
) +
# 4Ô∏è‚É£ Puntos de razas
geom_point(
data = olotillo.points,
aes(x = longitude, y = latitude, shape = Race, color = Race),
size = 1.8,
stroke = 0.8
) +
# 5Ô∏è‚É£ Escalas de raza
scale_shape_manual(
name = "Race",
values = c(
"Dzit-bacal" = 15,
"Mix" = 17,
"Olotillo" = 16,
"Tuxpe√±o" = 18
)
) +
scale_color_manual(
name = "Race",
values = c(
"Dzit-bacal" = "purple",
"Mix" = "green",
"Olotillo" = "blue",
"Tuxpe√±o" = "gold"
)
) +
# 6Ô∏è‚É£ Estilo visual limpio
theme_void() +
theme(
legend.position = c(0.85, 0.35),  # dentro del mapa
legend.title = element_text(size = 10, face = "bold"),
legend.text = element_text(size = 9),
legend.background = element_rect(fill = "white", color = "grey80"),
plot.margin = margin(10, 10, 10, 10)
) +
guides(
shape = guide_legend(title = "Race", override.aes = list(size = 3)),
color = guide_legend(title = "Race", override.aes = list(size = 3))
)
# Mostrar mapa
map3b
# --- Mapa limpio sin leyenda de estados, con "Race" visible -------------------
library(ggplot2)
library(sf)
library(dplyr)
# Asegurar que ENTIDAD es texto plano
mexico_sf$ENTIDAD <- as.character(mexico_sf$ENTIDAD)
# Crear campo binario para muestreados (solo para color base)
mexico_sf$muestreado <- ifelse(mexico_sf$ENTIDAD %in% c(
"CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO",
"SAN LUIS POTOSI", "VERACRUZ DE IGNACIO DE LA LLAVE"
), "Muestreado", "No muestreado")
# --- Crear mapa
map3b <- ggplot() +
# --- 1Ô∏è‚É£ Capa base de M√©xico (sin fill categ√≥rico, sin leyenda)
geom_sf(
data = mexico_sf,
aes(geometry = geometry),     # sin fill ni color en aes()
fill = "white",               # color de fondo fijo
color = "grey50",
linewidth = 0.25,
inherit.aes = FALSE,          # üö´ evita heredar ENTIDAD
show.legend = FALSE           # üö´ no genera leyenda
) +
# --- 2Ô∏è‚É£ Relleno gris para los estados muestreados (manual, sin aes)
geom_sf(
data = subset(mexico_sf, muestreado == "Muestreado"),
fill = "grey70",
color = "grey50",
linewidth = 0.25,
inherit.aes = FALSE,
show.legend = FALSE
) +
# --- 3Ô∏è‚É£ Capa de distribuci√≥n (opcional)
geom_sf(
data = distribution,
color = "black",
fill = NA,
linewidth = 0.3,
inherit.aes = FALSE,
show.legend = FALSE
) +
# --- 4Ô∏è‚É£ Puntos de PGMN
geom_point(
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
color = "black",
size = 0.6
) +
# --- 5Ô∏è‚É£ Puntos de razas
geom_point(
data = olotillo.points,
aes(x = longitude, y = latitude, shape = Race, color = Race),
size = 1.8,
stroke = 0.8
) +
# --- 6Ô∏è‚É£ Escalas de Race
scale_shape_manual(
name = "Race",
values = c(
"Dzit-bacal" = 15,
"Mix" = 17,
"Olotillo" = 16,
"Tuxpe√±o" = 18
)
) +
scale_color_manual(
name = "Race",
values = c(
"Dzit-bacal" = "purple",
"Mix" = "green",
"Olotillo" = "blue",
"Tuxpe√±o" = "gold"
)
) +
# --- 7Ô∏è‚É£ Tema limpio y leyenda
theme_void() +
theme(
legend.position = c(0.85, 0.35),
legend.title = element_text(size = 10, face = "bold"),
legend.text = element_text(size = 9),
legend.background = element_rect(fill = "white", color = "grey80")
) +
guides(
shape = guide_legend(title = "Race", override.aes = list(size = 3)),
color = guide_legend(title = "Race", override.aes = list(size = 3))
)
# Mostrar mapa
map3b
# --- Mapa final limpio con leyenda de "Race" ---------------------------------
# Asegurarse que ENTIDAD sea texto
mexico_sf$ENTIDAD <- as.character(mexico_sf$ENTIDAD)
# Crear una lista de estados muestreados
sampled.states <- c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO",
"SAN LUIS POTOSI", "VERACRUZ DE IGNACIO DE LA LLAVE")
# Crear un campo nuevo para los colores base
mexico_sf$color_fill <- ifelse(mexico_sf$ENTIDAD %in% sampled.states, "grey70", "white")
# --- Mapa
map3b <- ggplot() +
# 1Ô∏è‚É£ Pol√≠gonos base (sin aes, sin leyenda)
geom_sf(
data = mexico_sf,
fill = mexico_sf$color_fill,   # color fijo, no en aes()
colour = "grey50",
linewidth = 0.25
) +
# 2Ô∏è‚É£ Capa de distribuci√≥n (opcional)
geom_sf(
data = distribution,
colour = "black",
fill = NA,
linewidth = 0.3
) +
# 3Ô∏è‚É£ Puntos PGMN
geom_point(
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
colour = "black",
size = 0.6
) +
# 4Ô∏è‚É£ Puntos de razas
geom_point(
data = olotillo.points,
aes(x = longitude, y = latitude, shape = Race, color = Race),
size = 1.8,
stroke = 0.8
) +
# 5Ô∏è‚É£ Escalas de raza
scale_shape_manual(
name = "Race",
values = c(
"Dzit-bacal" = 15,
"Mix" = 17,
"Olotillo" = 16,
"Tuxpe√±o" = 18
)
) +
scale_color_manual(
name = "Race",
values = c(
"Dzit-bacal" = "purple",
"Mix" = "green",
"Olotillo" = "blue",
"Tuxpe√±o" = "gold"
)
) +
# 6Ô∏è‚É£ Estilo visual limpio
theme_void() +
theme(
legend.position = c(0.85, 0.35),  # dentro del mapa
legend.title = element_text(size = 10, face = "bold"),
legend.text = element_text(size = 9),
legend.background = element_rect(fill = "white", color = "grey80"),
plot.margin = margin(10, 10, 10, 10)
) +
guides(
shape = guide_legend(title = "Race", override.aes = list(size = 3)),
color = guide_legend(title = "Race", override.aes = list(size = 3))
)
# Mostrar mapa
map3b
# --- Create the map showing only sampled states -----------------------------------------
map3b <- ggplot() +
geom_sf(
data = mexico_sf,
aes(fill = ENTIDAD),
colour = "grey40",
linewidth = 0.3
) +
theme_void() +
theme(legend.position = "none") +
scale_fill_manual(
breaks = c(sampled.states, not.sampled),
values = c(
"grey60",     # base
"#75a842",    # verde
"#36dee6",    # turquesa
"#52bd85",    # verde medio
"#b94656",    # rojo
"#6780d8",    # azul
"#c69c39",    # dorado
"#b6b638",    # oliva
"#89863c",    # marr√≥n verdoso
rep("white", 23)
)
) +
geom_point(
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
colour = "black",
size = 0.6
) +
geom_point(
data = olotillo.points,
aes(x = longitude, y = latitude, shape = Race, color = Race),
size = 1.6
) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "blue", "orange")) +
theme_void() +
theme(legend.position = "bottom") +
guides(
shape = guide_legend(title = "Race"),
color = guide_legend(title = "Race")
)
map3b
