) +
ggtitle("Estados muestreados vs no muestreados") +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 13)
)
map2
map3 <- ggplot() +
geom_polygon(data = mexico_df, show.legend=FALSE,
aes(x = long, y = lat, group = group, fill =id ),
colour = "grey") +
# theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23))) + theme_void()
#shape file for siagro and olotillo points
map3 + geom_point(data = olotillo.PGMN,
size=0.4, colour = "black",
aes(x=longitud, y=latitud)) +
geom_polygon(data = distribution, size=0.1,
aes(x = long, y = lat, group = group),
colour = "pink", fill = NA) +
geom_point(data = olotillo.points, size=1.5,
aes(x = longitude, y = latitude, shape= Race, color= Race)) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "blue", "yellow"))  +
theme()
# --- Map showing only sampled states -----------------------------------------
map2 <- ggplot() +
geom_sf(
data = mexico_sf,
aes(fill = ENTIDAD),
colour = "grey40",
linewidth = 0.3
) +
theme_void() +
theme(legend.position = "none") +
scale_fill_manual(
breaks = c(sampled.states, not.sampled),
values = c(
"grey60",     # base
"#75a842",    # verde
"#36dee6",    # turquesa
"#52bd85",    # verde medio
"#b94656",    # rojo
"#6780d8",    # azul
"#c69c39",    # dorado
"#b6b638",    # oliva
"#89863c",    # marrón verdoso
rep("white", 23)
)
) +
ggtitle("Estados muestreados vs no muestreados") +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 13)
)
map2
# --- Map showing only sampled states -----------------------------------------
map2 <- ggplot() +
geom_sf(
data = mexico_sf,
aes(fill = ENTIDAD),
colour = "grey40",
linewidth = 0.3
) +
theme_void() +
theme(legend.position = "none") +
scale_fill_manual(
breaks = c(sampled.states, not.sampled),
values = c(
"grey60",     # base
"#75a842",    # verde
"#36dee6",    # turquesa
"#52bd85",    # verde medio
"#b94656",    # rojo
"#6780d8",    # azul
"#c69c39",    # dorado
"#b6b638",    # oliva
"#89863c",    # marrón verdoso
rep("white", 23)
)
) +
ggtitle("Estados muestreados vs no muestreados") +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 13)
)
map2
# --- Map showing only sampled states -----------------------------------------
map2 <- ggplot() +
geom_sf(
data = mexico_sf,
aes(fill = ENTIDAD),
colour = "grey40",
linewidth = 0.3
) +
theme_void() +
theme(legend.position = "none") +
scale_fill_manual(
breaks = c(sampled.states, not.sampled),
values = c(
"grey60",     # base
"#75a842",    # verde
"#36dee6",    # turquesa
"#52bd85",    # verde medio
"#b94656",    # rojo
"#6780d8",    # azul
"#c69c39",    # dorado
"#b6b638",    # oliva
"#89863c",    # marrón verdoso
rep("white", 23)
)
)
map2
# --- Load the package here (for reproducible routes) ----------------------------------------
if (requireNamespace("here", quietly = TRUE)) {
setwd(here::here())
message("📂  Working directory set to: ", getwd())
} else {
stop("⚠️ The 'here' package is not installed. Execute install.packages('here')")
}
map1 <- ggplot() +
geom_sf(data = mexico, colour = "grey", fill = NA) + # shape mexico
geom_sf(data = distribution, colour = "blue", fill = NA, size = 0.2) + # shape distribution
geom_point(data = olotillo.PGMN, aes(x = longitud, y = latitud), size = 0.5, colour = "black") +
geom_point(data = olotillo.points, aes(x = longitude, y = latitude, shape = Race, color = Race), size = 1.5) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "red", "orange")) +
theme_void()
map1
# --- Create the map --------------------------------------------------------
map2 <- ggplot() +
geom_sf(data = mexico, colour = "grey", fill = NA, linewidth = 0.3) + # base polygon of Mexico
geom_sf(data = distribution, colour = "purple", fill = NA, linewidth = 0.6) + # distribution polygon of Olotillo
geom_point(                         # points of PGMN
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
colour = "black",
size = 0.8
) +
theme_void() +                      # general style of the map
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold")
)
# --- Show map -----------------------------------------------------------
map2
# --- Create the map --------------------------------------------------------
map2 <- ggplot() +
geom_sf(data = mexico, colour = "grey", fill = NA, linewidth = 0.3) + # base polygon of Mexico
geom_sf(data = distribution, colour = "purple", fill = NA, linewidth = 0.6) + # distribution polygon of Olotillo
geom_point(                         # points of PGMN
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
colour = "black",
size = 0.8
) +
theme_void() +                      # general style of the map
# --- Show map --------------------------------------------------------------
map2
# --- Create the map --------------------------------------------------------
map2 <- ggplot() +
geom_sf(data = mexico, colour = "grey", fill = NA, linewidth = 0.3) + # base polygon of Mexico
geom_sf(data = distribution, colour = "purple", fill = NA, linewidth = 0.6) + # distribution polygon of Olotillo
geom_point(                         # points of PGMN
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
colour = "black",
size = 0.8
) +
theme_void()                       # general style of the map
# --- Show map --------------------------------------------------------------
map2
# ---- Extract coordinates and correctly join them with the attributes ---------------------------
coords <- st_coordinates(mexico) %>% as.data.frame()
coords$ID <- as.numeric(rownames(coords))   # create temporary ID
# ---- Convert geometries to data.frame (maintaining attributes) ---------------------------
mexico_df <- mexico %>%
st_drop_geometry() %>%                    # delete geometry (maintains attributes)
mutate(ID = row_number()) %>%             # create reference ID
right_join(coords, by = "ID")             # join with coordinates
head(mexico_df)                             # check result
# read the file plate1_fullmeta.txt
pop.data <- read.table(
here::here("meta", "plate1_fullmeta.txt"),
sep = "\t",
header = TRUE,
stringsAsFactors = FALSE
)
# order alphabetically pop.data
pop.data <- pop.data[order(pop.data$sample_name),]
# remove the first element, (DNA BLANK)
pop.data <- pop.data[-1,]
# check n samples
dim(pop.data)
# make vector of states excluding where we sampled olotillos
sampled.states<-unique(pop.data$state)
sampled.states
# to get a names in the data frame
# unique(mexico_df$id) # code original Alicia
unique(mexico_sf$ENTIDAD) # logica Duhyadi jun 2024
# change to they way
sampled.states<-c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO", "SAN LUIS POTOSI",
"VERACRUZ DE IGNACIO DE LA LLAVE")
# not.sampled<-unique(mexico_sf$id)[!unique(mexico_sf$id) %in% sampled.states] # code original Alicia
not.sampled<-unique(mexico_sf$ENTIDAD)[!unique(mexico_sf$ENTIDAD) %in% sampled.states] #logica Duhyadi jun 2024
## Map showing only sampled states
map2 <- ggplot()  +
geom_polygon(data = mexico_sf,
aes(x = long, y = lat, group = group, fill =ENTIDAD ), #fill =id ),
colour = "grey") + theme_void() +
theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23)))
map2
# --- Make vector of states excluding where we sampled olotillos --------------------------
# make vector of states excluding where we sampled olotillos
sampled.states<-unique(pop.data$state)
sampled.states
# --- Make vector of states excluding where we sampled olotillos --------------------------
sampled.states<-unique(pop.data$state)
sampled.states
# to get a names in the data frame
unique(mexico_sf$ENTIDAD)
# change to they way
sampled.states<-c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO", "SAN LUIS POTOSI",
"VERACRUZ DE IGNACIO DE LA LLAVE")
not.sampled<-unique(mexico_sf$ENTIDAD)[!unique(mexico_sf$ENTIDAD) %in% sampled.states]
# --- Create the map showing only sampled states -----------------------------------------
map3 <- ggplot()  +
geom_polygon(data = mexico_sf,
aes(x = long, y = lat, group = group, fill =ENTIDAD ), #fill =id ),
colour = "grey") + theme_void() +
theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23)))
map3
# --- Create the map showing only sampled states -----------------------------------------
map3 <- ggplot() +
geom_sf(
data = mexico_sf,
aes(fill = ENTIDAD),
colour = "grey40",
linewidth = 0.3
) +
theme_void() +
theme(legend.position = "none") +
scale_fill_manual(
breaks = c(sampled.states, not.sampled),
values = c(
"grey60",     # base
"#75a842",    # verde
"#36dee6",    # turquesa
"#52bd85",    # verde medio
"#b94656",    # rojo
"#6780d8",    # azul
"#c69c39",    # dorado
"#b6b638",    # oliva
"#89863c",    # marrón verdoso
rep("white", 23)
)
)
map3
map3 <- ggplot() +
geom_polygon(data = mexico_df, show.legend=FALSE,
aes(x = long, y = lat, group = group, fill =id ),
colour = "grey") +
# theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23))) + theme_void()
#shape file for siagro and olotillo points
map3 + geom_point(data = olotillo.PGMN,
size=0.4, colour = "black",
aes(x=longitud, y=latitud)) +
geom_polygon(data = distribution, size=0.1,
aes(x = long, y = lat, group = group),
colour = "pink", fill = NA) +
geom_point(data = olotillo.points, size=1.5,
aes(x = longitude, y = latitude, shape= Race, color= Race)) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "blue", "yellow"))  +
theme()
# --- Create the map showing only sampled states -----------------------------------------
map3b <- ggplot() +
geom_sf(
data = mexico_sf,
aes(fill = ENTIDAD),
colour = "grey40",
linewidth = 0.3
) +
theme_void() +
theme(legend.position = "none") +
scale_fill_manual(
breaks = c(sampled.states, not.sampled),
values = c(
"grey60",     # base
"#75a842",    # verde
"#36dee6",    # turquesa
"#52bd85",    # verde medio
"#b94656",    # rojo
"#6780d8",    # azul
"#c69c39",    # dorado
"#b6b638",    # oliva
"#89863c",    # marrón verdoso
rep("white", 23)
)
)
map3b
#shape file for siagro and olotillo points
map3b + geom_point(data = olotillo.PGMN,
size=0.4, colour = "black",
aes(x=longitud, y=latitud)) +
geom_polygon(data = distribution, size=0.1,
aes(x = long, y = lat, group = group),
colour = "pink", fill = NA) +
geom_point(data = olotillo.points, size=1.5,
aes(x = longitude, y = latitude, shape= Race, color= Race)) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "blue", "yellow"))  +
theme()
# --- Create the map showing only sampled states -----------------------------------------
map3b <- ggplot() +
geom_sf(
data = mexico_sf,
aes(fill = ENTIDAD),
colour = "grey40",
linewidth = 0.3
) +
geom_sf(
data = distribution,
colour = "deeppink",
fill = NA,
linewidth = 0.4
) +
geom_point(
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
colour = "black",
size = 0.6
) +
geom_point(
data = olotillo.points,
aes(x = longitude, y = latitude, shape = Race, color = Race),
size = 1.6
) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "blue", "orange")) +
theme_void() +
theme(legend.position = "bottom") +
guides(
shape = guide_legend(title = "Race"),
color = guide_legend(title = "Race")
)
# Mostrar el mapa
map3b
# --- Create the map showing only sampled states -----------------------------------------
map3b <- ggplot() +
geom_sf(
data = mexico_sf,
aes(fill = ENTIDAD),
colour = "grey40",
linewidth = 0.3
) +
geom_point(
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
colour = "black",
size = 0.6
) +
geom_point(
data = olotillo.points,
aes(x = longitude, y = latitude, shape = Race, color = Race),
size = 1.6
) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "blue", "orange")) +
theme_void() +
theme(legend.position = "bottom") +
guides(
shape = guide_legend(title = "Race"),
color = guide_legend(title = "Race")
)
# Mostrar el mapa
map3b
# --- Create the map showing only sampled states -----------------------------------------
map3b <- ggplot() +
geom_sf(
data = mexico_sf,
aes(fill = ENTIDAD),
colour = "grey40",
linewidth = 0.3
) +
theme_void() +
theme(legend.position = "none") +
scale_fill_manual(
breaks = c(sampled.states, not.sampled),
values = c(
"grey60",     # base
"#75a842",    # verde
"#36dee6",    # turquesa
"#52bd85",    # verde medio
"#b94656",    # rojo
"#6780d8",    # azul
"#c69c39",    # dorado
"#b6b638",    # oliva
"#89863c",    # marrón verdoso
rep("white", 23)
)
)
+
geom_point(
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
colour = "black",
size = 0.6
) +
geom_point(
data = olotillo.points,
aes(x = longitude, y = latitude, shape = Race, color = Race),
size = 1.6
) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "blue", "orange")) +
theme_void() +
theme(legend.position = "bottom") +
guides(
shape = guide_legend(title = "Race"),
color = guide_legend(title = "Race")
)
# --- Create the map showing only sampled states -----------------------------------------
map3b <- ggplot() +
geom_sf(
data = mexico_sf,
aes(fill = ENTIDAD),
colour = "grey40",
linewidth = 0.3
) +
theme_void() +
theme(legend.position = "none") +
scale_fill_manual(
breaks = c(sampled.states, not.sampled),
values = c(
"grey60",     # base
"#75a842",    # verde
"#36dee6",    # turquesa
"#52bd85",    # verde medio
"#b94656",    # rojo
"#6780d8",    # azul
"#c69c39",    # dorado
"#b6b638",    # oliva
"#89863c",    # marrón verdoso
rep("white", 23)
)
) +
geom_point(
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
colour = "black",
size = 0.6
) +
geom_point(
data = olotillo.points,
aes(x = longitude, y = latitude, shape = Race, color = Race),
size = 1.6
) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "blue", "orange")) +
theme_void() +
theme(legend.position = "bottom") +
guides(
shape = guide_legend(title = "Race"),
color = guide_legend(title = "Race")
)
map3b
