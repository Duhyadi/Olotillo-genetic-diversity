library(rgdal)
library(dplyr)
library(ggplot2)
library(gpclib)
library(maptools)
library(rgeos)
library(rgdal)
library(dplyr)
library(ggplot2)
library(gpclib)
library(maptools)
library(rgeos)
library(rgdal)
# mexico shape
mexico <- readOGR(dsn="destdv1gw", layer="destdv1gw")
# olotillo, distribution shape
distribution <-readOGR(dsn="oloti_7cgw", layer="oloti_7cgw")
# olotillo, Proyecto Global Maíces Nativos (PGMN)
olotillo.PGMN <- read.csv("olotillo_PGMN_siagro.csv")
# olotillo, samples
olotillo.points <- read.csv("meta/olotillo_points_meta_clean.csv")
# shape file for mexico and potential distribution
map <- ggplot() +
geom_polygon(data = mexico,
aes(x = long, y = lat, group = group),
colour = "grey", fill = NA) + theme_void() +
geom_polygon(data = distribution, size=0.2,
aes(x = long, y = lat, group = group),
colour = "blue", fill = NA) + theme_void()
# shape file for olotillo, PGMN and and the collections for this study
map + geom_point(data = olotillo.PGMN,
size= 0.5, colour = "black",
aes(x=longitud, y=latitud)) +
geom_point(data = olotillo.points, size=1.5,
aes(x = longitude, y = latitude, shape= Race, color= Race)) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "red", "orange"))
# shape file for mexico and potential distribution
map <- ggplot() +
geom_polygon(data = mexico, # shape-mexico
aes(x = long, y = lat, group = group),
colour = "grey", fill = NA) + theme_void() +
geom_polygon(data = distribution, size=1, # shape-distri.
aes(x = long, y = lat, group = group),
colour = "purple", fill = NA) + theme_void()
# shape file for siagro and olotillo points
map + geom_point(data = olotillo.PGMN, # points-olo.PGMN
size= 0.5, colour = "black",
aes(x=longitud, y=latitud))
#install.packages("units")
library(sf)
mexico_sf <- st_as_sf(mexico)
lapply(mexico_sf, class)
print(mexico_sf)
View(mexico_sf)
mexico_sf <- st_as_sf(mexico, region = "ENTIDAD")
View(mexico_sf)
mexico_sf <- st_as_sf(mexico, region = "ENTIDAD")
lapply(mexico_sf, class)
print(mexico_sf)
unique(mexico_sf$ENTIDAD)
unique(mexico_sf$ENTIDAD)
sampled.states<-c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO", "SAN LUIS POTOSI",
"VERACRUZ DE IGNACIO DE LA LLAVE")
# to get a names in the data frame
# unique(mexico_sf$id) # code original Alicia
unique(mexico_sf$ENTIDAD) # logica Duhyadi jun 2024
# change to they way
sampled.states<-c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO", "SAN LUIS POTOSI",
"VERACRUZ DE IGNACIO DE LA LLAVE")
# not.sampled<-unique(mexico_sf$id)[!unique(mexico_sf$id) %in% sampled.states] # code original Alicia
not.sampled<-unique(mexico_sf$ENTIDAD)[!unique(mexico_sf$ENTIDAD) %in% sampled.states] #logica Duhyadi jun 2024
## Map showing only sampled states
map2 <- ggplot()  +
geom_polygon(data = mexico_sf,
aes(x = long, y = lat, group = group, fill =ENTIDAD ), #fill =id ),
colour = "grey") + theme_void() +
theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23)))# +
#  geom_polygon(data = distribution,
# aes(x = long, y = lat, group = group),
# colour = "blue", fill = NA) + theme_void()
map2
# mexico shape
mexico <- readOGR(dsn="destdv1gw", layer="destdv1gw")
library(dplyr)
library(ggplot2)
library(gpclib)
library(maptools)
library(rgeos)
library(rgdal)
# mexico shape
mexico <- readOGR(dsn="destdv1gw", layer="destdv1gw")
# olotillo, distribution shape
distribution <-readOGR(dsn="oloti_7cgw", layer="oloti_7cgw")
# olotillo, Proyecto Global Maíces Nativos (PGMN)
olotillo.PGMN <- read.csv("olotillo_PGMN_siagro.csv")
# olotillo, samples
olotillo.points <- read.csv("meta/olotillo_points_meta_clean.csv")
View(olotillo.points)
library(dplyr)
library(ggplot2)
library(gpclib)
library(maptools)
library(rgeos)
library(rgdal)
# mexico shape
mexico <- readOGR(dsn="destdv1gw", layer="destdv1gw")
# olotillo, distribution shape
distribution <-readOGR(dsn="oloti_7cgw", layer="oloti_7cgw")
# olotillo, Proyecto Global Maíces Nativos (PGMN)
olotillo.PGMN <- read.csv("olotillo_PGMN_siagro.csv")
# olotillo, samples
olotillo.points <- read.csv("meta/olotillo_points_meta_clean.csv")
View(olotillo.points)
library(dplyr)
library(ggplot2)
library(gpclib)
library(maptools)
library(rgeos)
library(rgdal)
# mexico shape
mexico <- readOGR(dsn="destdv1gw", layer="destdv1gw")
# olotillo, distribution shape
distribution <-readOGR(dsn="oloti_7cgw", layer="oloti_7cgw")
# olotillo, Proyecto Global Maíces Nativos (PGMN)
olotillo.PGMN <- read.csv("olotillo_PGMN_siagro.csv")
# olotillo, samples
olotillo.points <- read.csv("meta/olotillo_points_meta_clean.csv")
# shape file for mexico and potential distribution
map <- ggplot() +
geom_polygon(data = mexico, # shape-mexico
aes(x = long, y = lat, group = group),
colour = "grey", fill = NA) + theme_void() +
geom_polygon(data = distribution, size=0.2, # shape-distri.
aes(x = long, y = lat, group = group),
colour = "blue", fill = NA) + theme_void()
# shape file for olotillo, PGMN and and the collections for this study
map + geom_point(data = olotillo.PGMN, # points-olo.PGMN
size= 0.5, colour = "black",
aes(x=longitud, y=latitud)) +
geom_point(data = olotillo.points, size=1.5, # points-study
aes(x = longitude, y = latitude, shape= Race, color= Race)) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "red", "orange"))
# shape file for mexico and potential distribution
map <- ggplot() +
geom_polygon(data = mexico, # shape-mexico
aes(x = long, y = lat, group = group),
colour = "grey", fill = NA) + theme_void() +
geom_polygon(data = distribution, size=1, # shape-distri.
aes(x = long, y = lat, group = group),
colour = "purple", fill = NA) + theme_void()
# shape file for siagro and olotillo points
map + geom_point(data = olotillo.PGMN, # points-olo.PGMN
size= 0.5, colour = "black",
aes(x=longitud, y=latitud))
library(broom)
packageVersion("broom")
#install.packages("units")
library(sf)
mexico_sf <- st_as_sf(mexico, region = "ENTIDAD")
lapply(mexico_sf, class)
print(mexico_sf)
# transform shape to df
# broom package, convert statistical objects into Tidy Tibbles
mexico_df <- broom::tidy(mexico, region = "ENTIDAD")
# transform shape to df
# broom package, convert statistical objects into Tidy Tibbles
mexico_df <- broom::tidy(mexico, region = "ENTIDAD")
# read the file plate1_fullmeta.txt
pop.data <- read.table("meta/plate1_fullmeta.txt", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
# order alphabetically pop.data
pop.data <- pop.data[order(pop.data$sample_name),]
# remove the first element, (DNA BLANK)
pop.data <- pop.data[-1,]
# check n samples
dim(pop.data)
# read the file plate1_fullmeta.txt
pop.data <- read.table("meta/plate1_fullmeta.txt", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
# order alphabetically pop.data
pop.data <- pop.data[order(pop.data$sample_name),]
# remove the first element, (DNA BLANK)
pop.data <- pop.data[-1,]
# check n samples
dim(pop.data)
# make vector of states excluding where we sampled olotillos
sampled.states<-unique(pop.data$state)
sampled.states
# make vector of states excluding where we sampled olotillos
sampled.states<-unique(pop.data$state)
sampled.states
library(ggplot2)
# to get a names in the data frame
# unique(mexico_df$id) # code original Alicia
unique(mexico_sf$ENTIDAD) # logica Duhyadi jun 2024
# change to they way
sampled.states<-c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO", "SAN LUIS POTOSI",
"VERACRUZ DE IGNACIO DE LA LLAVE")
# not.sampled<-unique(mexico_sf$id)[!unique(mexico_sf$id) %in% sampled.states] # code original Alicia
not.sampled<-unique(mexico_sf$ENTIDAD)[!unique(mexico_sf$ENTIDAD) %in% sampled.states] #logica Duhyadi jun 2024
## Map showing only sampled states
map2 <- ggplot()  +
geom_polygon(data = mexico_sf,
aes(x = long, y = lat, group = group, fill =ENTIDAD ), #fill =id ),
colour = "grey") + theme_void() +
theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23)))# +
#  geom_polygon(data = distribution,
# aes(x = long, y = lat, group = group),
# colour = "blue", fill = NA) + theme_void()
map2
map3 <- ggplot() +
geom_polygon(data = mexico_df, show.legend=FALSE,
aes(x = long, y = lat, group = group, fill =id ),
colour = "grey") +
# theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23))) + theme_void()
# read the file plate1_fullmeta.txt
pop.data <- read.table("meta/plate1_fullmeta.txt", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
# order alphabetically pop.data
pop.data <- pop.data[order(pop.data$sample_name),]
# remove the first element, (DNA BLANK)
pop.data <- pop.data[-1,]
# check n samples
dim(pop.data)
# transform shape to df
# broom package, convert statistical objects into Tidy Tibbles
mexico_df <- broom::tidy(mexico, region = "ENTIDAD")
# make vector of states excluding where we sampled olotillos
sampled.states<-unique(pop.data$state)
sampled.states
library(ggplot2)
# to get a names in the data frame
# unique(mexico_df$id) # code original Alicia
unique(mexico_sf$ENTIDAD) # logica Duhyadi jun 2024
# change to they way
sampled.states<-c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO", "SAN LUIS POTOSI",
"VERACRUZ DE IGNACIO DE LA LLAVE")
# not.sampled<-unique(mexico_sf$id)[!unique(mexico_sf$id) %in% sampled.states] # code original Alicia
not.sampled<-unique(mexico_sf$ENTIDAD)[!unique(mexico_sf$ENTIDAD) %in% sampled.states] #logica Duhyadi jun 2024
## Map showing only sampled states
map2 <- ggplot()  +
geom_polygon(data = mexico_sf,
aes(x = long, y = lat, group = group, fill =ENTIDAD ), #fill =id ),
colour = "grey") + theme_void() +
theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23)))# +
#  geom_polygon(data = distribution,
# aes(x = long, y = lat, group = group),
# colour = "blue", fill = NA) + theme_void()
map2
# Configuración inicial del proyecto -----------------------------------------
# Cargar el paquete here (para rutas reproducibles)
if (requireNamespace("here", quietly = TRUE)) {
setwd(here::here())
message("📂 Directorio de trabajo fijado en: ", getwd())
} else {
stop("⚠️ El paquete 'here' no está instalado. Ejecuta install.packages('here')")
}
library(dplyr)
library(ggplot2)
#library(gpclib) # ya no funciona, se puede sustituir con el uso de sf
# library(maptools) # al igual que gpclib, el paquete maptools fue retirado de CRAN en 2023.
# library(rgeos) # en proceso de retiro
#library(rgdal) #el paquete rgdal también fue retirado oficialmente de CRAN en 2023 (junto con rgeos y maptools).
library(sf)
Mexico <- st_read(here("shape", "destdv1gw.shp"))
library(dplyr)
library(ggplot2)
#library(gpclib) # ya no funciona, se puede sustituir con el uso de sf
# library(maptools) # al igual que gpclib, el paquete maptools fue retirado de CRAN en 2023.
# library(rgeos) # en proceso de retiro
#library(rgdal) #el paquete rgdal también fue retirado oficialmente de CRAN en 2023 (junto con rgeos y maptools).
library(sf)
library(dplyr)
library(ggplot2)
#library(gpclib) # ya no funciona, se puede sustituir con el uso de sf
# library(maptools) # al igual que gpclib, el paquete maptools fue retirado de CRAN en 2023.
# library(rgeos) # en proceso de retiro
#library(rgdal) #el paquete rgdal también fue retirado oficialmente de CRAN en 2023 (junto con rgeos y maptools).
library(sf)
Mexico <- st_read(here("shape", "destdv1gw.shp"))
install.packages("here")
"here" %in% rownames(installed.packages())
# Configuración inicial del proyecto -----------------------------------------
# Cargar el paquete here (para rutas reproducibles)
if (requireNamespace("here", quietly = TRUE)) {
setwd(here::here())
message("📂 Directorio de trabajo fijado en: ", getwd())
} else {
stop("⚠️ El paquete 'here' no está instalado. Ejecuta install.packages('here')")
}
Mexico <- st_read(here::here("shape", "destdv1gw.shp"))
"here" %in% rownames(installed.packages())
# Configuración inicial del proyecto -----------------------------------------
# Cargar el paquete here (para rutas reproducibles)
if (requireNamespace("here", quietly = TRUE)) {
setwd(here::here())
message("📂 Directorio de trabajo fijado en: ", getwd())
} else {
stop("⚠️ El paquete 'here' no está instalado. Ejecuta install.packages('here')")
}
library(dplyr)
library(ggplot2)
#library(gpclib) # ya no funciona, se puede sustituir con el uso de sf
# library(maptools) # al igual que gpclib, el paquete maptools fue retirado de CRAN en 2023.
# library(rgeos) # en proceso de retiro
#library(rgdal) #el paquete rgdal también fue retirado oficialmente de CRAN en 2023 (junto con rgeos y maptools).
library(sf)
Mexico <- st_read(here::here("shape", "destdv1gw.shp"))
# Configuración inicial del proyecto -----------------------------------------
# Cargar el paquete here (para rutas reproducibles)
if (requireNamespace("here", quietly = TRUE)) {
setwd(here::here())
message("📂 Directorio de trabajo fijado en: ", getwd())
} else {
stop("⚠️ El paquete 'here' no está instalado. Ejecuta install.packages('here')")
}
library(dplyr)
library(ggplot2)
#library(gpclib) # ya no funciona, se puede sustituir con el uso de sf
# library(maptools) # al igual que gpclib, el paquete maptools fue retirado de CRAN en 2023.
# library(rgeos) # en proceso de retiro
#library(rgdal) #el paquete rgdal también fue retirado oficialmente de CRAN en 2023 (junto con rgeos y maptools).
library(sf)
Mexico <- st_read(here::here("shape","destdv1gw" ,"destdv1gw.shp"))
View(Mexico)
# Olotillo distribution shape
distribution <- st_read(here:here("shape","oloti_7cgw" ,"oloti_7cgw"))
# Olotillo distribution shape
distribution <- st_read(here::here("shape","oloti_7cgw" ,"oloti_7cgw"))
# Olotillo distribution shape
distribution <- st_read(here::here("shape","oloti_7cgw" ,"oloti_7cgw.shp"))
View(distribution)
# Olotillo, Proyecto Global Maíces Nativos (PGMN)
olotillo.PGMN <- read.csv(here::here("meta","olotillo_PGMN_siagro.csv"))
# Olotillo, Proyecto Doctoral Poblaciones Evolutivas"
olotillo.points <- read.csv(here::here("meta", "olotillo_points_meta_clean.csv")
olotillo.points <- read.csv(here::here("meta", "olotillo_points_meta_clean.csv")
# Olotillo, Proyecto Doctoral Poblaciones Evolutivas"
olotillo.points <- read.csv(here::here("meta", "olotillo_points_meta_clean.csv"))
```
View(olotillo.points)
# shape file for mexico and potential distribution
map <- ggplot() +
geom_polygon(data = mexico, # shape-mexico
aes(x = long, y = lat, group = group),
colour = "grey", fill = NA) + theme_void() +
geom_polygon(data = distribution, size=0.2, # shape-distri.
aes(x = long, y = lat, group = group),
colour = "blue", fill = NA) + theme_void()
# shape file for olotillo, PGMN and and the collections for this study
map + geom_point(data = olotillo.PGMN, # points-olo.PGMN
size= 0.5, colour = "black",
aes(x=longitud, y=latitud)) +
geom_point(data = olotillo.points, size=1.5, # points-study
aes(x = longitude, y = latitude, shape= Race, color= Race)) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "red", "orange"))
# SHAPES
# Mexico shape
mexico <- st_read(here::here("shape","destdv1gw" ,"destdv1gw.shp"))
# Olotillo distribution shape
distribution <- st_read(here::here("shape","oloti_7cgw" ,"oloti_7cgw.shp"))
# POINTS
# Olotillo, Proyecto Global Maíces Nativos (PGMN)
olotillo.PGMN <- read.csv(here::here("meta","olotillo_PGMN_siagro.csv"))
# Olotillo, Proyecto Doctoral Poblaciones Evolutivas"
olotillo.points <- read.csv(here::here("meta", "olotillo_points_meta_clean.csv"))
# shape file for mexico and potential distribution
map <- ggplot() +
geom_polygon(data = mexico, # shape-mexico
aes(x = long, y = lat, group = group),
colour = "grey", fill = NA) + theme_void() +
geom_polygon(data = distribution, size=0.2, # shape-distri.
aes(x = long, y = lat, group = group),
colour = "blue", fill = NA) + theme_void()
# shape file for olotillo, PGMN and and the collections for this study
map + geom_point(data = olotillo.PGMN, # points-olo.PGMN
size= 0.5, colour = "black",
aes(x=longitud, y=latitud)) +
geom_point(data = olotillo.points, size=1.5, # points-study
aes(x = longitude, y = latitude, shape= Race, color= Race)) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "red", "orange"))
# Initial project setup-----------------------------------------
# Load the package here (for reproducible routes)
if (requireNamespace("here", quietly = TRUE)) {
setwd(here::here())
message("📂  Working directory set to: ", getwd())
} else {
stop("⚠️ The 'here' package is not installed. Execute install.packages('here')")
}
library(dplyr)
library(ggplot2)
# library(gpclib) # officially retired from CRAN in 2023, replace with sf
# library(maptools) # like gpclib, the maptools package was removed from CRAN in 2023, replace with sf
# library(rgeos) # in the process of retirement, replace with sf
#library(rgdal) # was also officially retired from CRAN in 2023 (along with rgeos and maptools, replace with sf
library(sf)
# SHAPES
# Mexico shape
mexico <- st_read(here::here("shape","destdv1gw" ,"destdv1gw.shp"))
# Olotillo distribution shape
distribution <- st_read(here::here("shape","oloti_7cgw" ,"oloti_7cgw.shp"))
# POINTS
# Olotillo, Proyecto Global Maíces Nativos (PGMN)
olotillo.PGMN <- read.csv(here::here("meta","olotillo_PGMN_siagro.csv"))
# Olotillo, Proyecto Doctoral Poblaciones Evolutivas"
olotillo.points <- read.csv(here::here("meta", "olotillo_points_meta_clean.csv"))
# shape file for mexico and potential distribution
map <- ggplot() +
geom_polygon(data = mexico, # shape mexico
aes(x = long, y = lat, group = group),
colour = "grey", fill = NA) + theme_void() +
geom_polygon(data = distribution, size=0.2, # shape distribution
aes(x = long, y = lat, group = group),
colour = "blue", fill = NA) + theme_void()
# points file for olotillo, PGMN and and the collections for this study
map + geom_point(data = olotillo.PGMN, # points-olo.PGMN
size= 0.5, colour = "black",
aes(x=longitud, y=latitud)) +
geom_point(data = olotillo.points, size=1.5, # points-study
aes(x = longitude, y = latitude, shape= Race, color= Race)) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "red", "orange"))
map <- ggplot() +
geom_sf(data = mexico, colour = "grey", fill = NA) +
geom_sf(data = distribution, colour = "blue", fill = NA, size = 0.2) +
geom_point(data = olotillo.PGMN, aes(x = longitud, y = latitud), size = 0.5, colour = "black") +
geom_point(data = olotillo.points, aes(x = longitude, y = latitude, shape = Race, color = Race), size = 1.5) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "red", "orange")) +
theme_void()
map
# Initial project setup-----------------------------------------
# Load the package here (for reproducible routes)
if (requireNamespace("here", quietly = TRUE)) {
setwd(here::here())
message("📂  Working directory set to: ", getwd())
} else {
stop("⚠️ The 'here' package is not installed. Execute install.packages('here')")
}
# --- Load spatial layers and data ----------------------------------------
mexico <- st_read(here("shape", "destdv1gw.shp"))        #  shape of Mexico
distribution <- st_read(here("shape", "oloti_7cgw.shp")) # shape of distribution
olotillo.PGMN <- read.csv(here("meta", "olotillo_PGMN_siagro.csv")) # points PGMN
# --- Create the map --------------------------------------------------------
map <- ggplot() +
geom_sf(data = mexico, colour = "grey", fill = NA, linewidth = 0.3) + # base polygon of Mexico
geom_sf(data = distribution, colour = "purple", fill = NA, linewidth = 0.6) + # distribution polygon
geom_point(                         # points of PGMN
data = olotillo.PGMN,
aes(x = longitud, y = latitud),
colour = "black",
size = 0.8
) +
theme_void() +                      # general style of the map
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold")
) + # general style of the map
# --- Show map -----------------------------------------------------------
map
