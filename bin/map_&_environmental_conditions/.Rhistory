aes(x = long, y = lat, group = group),
colour = "grey", fill = NA) + theme_void() +
geom_polygon(data = distribution, size=1,
aes(x = long, y = lat, group = group),
colour = "purple", fill = NA) + theme_void()
# shape file for siagro and olotillo points
map + geom_point(data = olotillo.PGMN,
size= 0.5, colour = "black",
aes(x=longitud, y=latitud))
library(broom)
packageVersion("broom")
# transfomr shape to df
# broom package, convert statistical objects into Tidy Tibbles
mexico_df <- broom::tidy(mexico, region = "ENTIDAD")
# transform shape to df
# broom package, convert statistical objects into Tidy Tibbles
mexico_df <- broom::tidy(mexico, region = "ENTIDAD")
mexico_df <- broom::tidy(mexico, region = "ENTIDAD")
# transform shape to df
# broom package, convert statistical objects into Tidy Tibbles
mexico_df <- broom::tidy(mexico, region = "ENTIDAD")
mexico_df <-broom:::tidy.SpatialPolygonsDataFrame(mexico, region = "ENTIDAD")
library(dplyr)
library(ggplot2)
library(gpclib)
library(maptools)
library(rgeos)
library(rgdal)
# read shape and points
# mexico shape
mexico <- readOGR(dsn="destdv1gw", layer="destdv1gw")
# Olotillo distribution shape
distribution <-readOGR(dsn="oloti_7cgw", layer="oloti_7cgw")
# Olotillo Proyecto Global Maíces Nativos,PGMN
olotillo.PGMN <- read.csv("olotillo_PGMN_siagro.csv")
# samples Olotillo
olotillo.points <- read.csv("meta/olotillo_points_meta_clean.csv")
# shape file for mexico and potential distribution
map <- ggplot() +
geom_polygon(data = mexico,
aes(x = long, y = lat, group = group),
colour = "grey", fill = NA) + theme_void() +
geom_polygon(data = distribution, size=0.2,
aes(x = long, y = lat, group = group),
colour = "blue", fill = NA) + theme_void()
# shape file for siagro and olotillo points by races
map + geom_point(data = olotillo.PGMN,
size= 0.5, colour = "black",
aes(x=longitud, y=latitud)) +
geom_point(data = olotillo.points, size=1.5,
aes(x = longitude, y = latitude, shape= Race, color= Race)) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "red", "orange"))
# shape file for mexico and potential distribution
map <- ggplot() +
geom_polygon(data = mexico,
aes(x = long, y = lat, group = group),
colour = "grey", fill = NA) + theme_void() +
geom_polygon(data = distribution, size=1,
aes(x = long, y = lat, group = group),
colour = "purple", fill = NA) + theme_void()
# shape file for siagro and olotillo points
map + geom_point(data = olotillo.PGMN,
size= 0.5, colour = "black",
aes(x=longitud, y=latitud))
library(broom)
packageVersion("broom")
mexico_df <-broom:::tidy.SpatialPolygonsDataFrame(mexico, region = "ENTIDAD")
# transform shape to df
# broom package, convert statistical objects into Tidy Tibbles
mexico_df <- broom::tidy(mexico, region = "ENTIDAD")
# transform shape to df
# broom package, convert statistical objects into Tidy Tibbles
mexico_df <- broom::tidy(mexico, region = "ENTIDAD")
install.packages("sf")
library(sf)
install.packages("sf")
install.packages("units")
install.packages("sf")
library(sf)
remove.packages("units")
remove.packages("sf")
install.packages("units")
install.packages("units")
install.packages("sf")
library(sf)
mexico_sf <- st_as_sf(mexico)
View(mexico_sf)
lapply(mexico_df, class)
lapply(mexico_sf, class)
# read the file plate1_fullmeta.txt
pop.data <- read.table("meta/plate1_fullmeta.txt", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
# order alphabetically pop.data
pop.data <- pop.data[order(pop.data$sample_name),]
# remove the first element, (DNA BLANK)
pop.data <- pop.data[-1,]
# check n samples
dim(pop.data)
# make vector of states excluding where we sampled olotillos
sampled.states<-unique(pop.data$state)
sampled.states
# to get a names in the data frame
unique(mexico_df$id)
# to get a names in the data frame
unique(mexico_sf$id)
# change to they way
sampled.states<-c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO", "SAN LUIS POTOSI",
"VERACRUZ DE IGNACIO DE LA LLAVE")
not.sampled<-unique(mexico_sf$id)[!unique(mexico_sf$id) %in% sampled.states]
## Map showing only sampled states
map2 <- ggplot()  +
geom_polygon(data = mexico_sf,
aes(x = long, y = lat, group = group, fill =id ),
colour = "grey") + theme_void() +
theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23)))# +
library(ggplot2)
# to get a names in the data frame
unique(mexico_sf$id)
# change to they way
sampled.states<-c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO", "SAN LUIS POTOSI",
"VERACRUZ DE IGNACIO DE LA LLAVE")
not.sampled<-unique(mexico_sf$id)[!unique(mexico_sf$id) %in% sampled.states]
## Map showing only sampled states
map2 <- ggplot()  +
geom_polygon(data = mexico_sf,
aes(x = long, y = lat, group = group, fill =id ),
colour = "grey") + theme_void() +
theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23)))# +
#  geom_polygon(data = distribution,
# aes(x = long, y = lat, group = group),
# colour = "blue", fill = NA) + theme_void()
map2
mexico_sf <- st_as_sf(mexico)
lapply(mexico_sf, class)
print(mexico_sf)
View(mexico_sf)
unique(mexico_sf$id)
# to get a names in the data frame
unique(mexico_sf$id)
# change to they way
sampled.states<-c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO", "SAN LUIS POTOSI",
"VERACRUZ DE IGNACIO DE LA LLAVE")
not.sampled<-unique(mexico_sf$id)[!unique(mexico_sf$id) %in% sampled.states]
## Map showing only sampled states
map2 <- ggplot()  +
geom_polygon(data = mexico_sf,
aes(x = long, y = lat, group = group, fill =id ),
colour = "grey") + theme_void() +
theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23)))# +
#  geom_polygon(data = distribution,
# aes(x = long, y = lat, group = group),
# colour = "blue", fill = NA) + theme_void()
map2
library(dplyr)
library(ggplot2)
library(gpclib)
library(maptools)
library(rgeos)
library(rgdal)
# read shape and points
# mexico shape
mexico <- readOGR(dsn="destdv1gw", layer="destdv1gw")
# Olotillo, distribution shape
distribution <-readOGR(dsn="oloti_7cgw", layer="oloti_7cgw")
# Olotillo, Proyecto Global Maíces Nativos, PGMN
olotillo.PGMN <- read.csv("olotillo_PGMN_siagro.csv")
# samples Olotillo
olotillo.points <- read.csv("meta/olotillo_points_meta_clean.csv")
library(dplyr)
library(ggplot2)
library(gpclib)
library(maptools)
library(rgeos)
library(rgdal)
library(dplyr)
library(ggplot2)
library(gpclib)
library(maptools)
library(rgeos)
library(rgdal)
library(dplyr)
library(ggplot2)
library(gpclib)
library(maptools)
library(rgeos)
library(rgdal)
# mexico shape
mexico <- readOGR(dsn="destdv1gw", layer="destdv1gw")
# olotillo, distribution shape
distribution <-readOGR(dsn="oloti_7cgw", layer="oloti_7cgw")
# olotillo, Proyecto Global Maíces Nativos (PGMN)
olotillo.PGMN <- read.csv("olotillo_PGMN_siagro.csv")
# olotillo, samples
olotillo.points <- read.csv("meta/olotillo_points_meta_clean.csv")
# shape file for mexico and potential distribution
map <- ggplot() +
geom_polygon(data = mexico,
aes(x = long, y = lat, group = group),
colour = "grey", fill = NA) + theme_void() +
geom_polygon(data = distribution, size=0.2,
aes(x = long, y = lat, group = group),
colour = "blue", fill = NA) + theme_void()
# shape file for olotillo, PGMN and and the collections for this study
map + geom_point(data = olotillo.PGMN,
size= 0.5, colour = "black",
aes(x=longitud, y=latitud)) +
geom_point(data = olotillo.points, size=1.5,
aes(x = longitude, y = latitude, shape= Race, color= Race)) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "red", "orange"))
# shape file for mexico and potential distribution
map <- ggplot() +
geom_polygon(data = mexico, # shape-mexico
aes(x = long, y = lat, group = group),
colour = "grey", fill = NA) + theme_void() +
geom_polygon(data = distribution, size=1, # shape-distri.
aes(x = long, y = lat, group = group),
colour = "purple", fill = NA) + theme_void()
# shape file for siagro and olotillo points
map + geom_point(data = olotillo.PGMN, # points-olo.PGMN
size= 0.5, colour = "black",
aes(x=longitud, y=latitud))
#install.packages("units")
library(sf)
mexico_sf <- st_as_sf(mexico)
lapply(mexico_sf, class)
print(mexico_sf)
View(mexico_sf)
mexico_sf <- st_as_sf(mexico, region = "ENTIDAD")
View(mexico_sf)
mexico_sf <- st_as_sf(mexico, region = "ENTIDAD")
lapply(mexico_sf, class)
print(mexico_sf)
unique(mexico_sf$ENTIDAD)
unique(mexico_sf$ENTIDAD)
sampled.states<-c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO", "SAN LUIS POTOSI",
"VERACRUZ DE IGNACIO DE LA LLAVE")
# to get a names in the data frame
# unique(mexico_sf$id) # code original Alicia
unique(mexico_sf$ENTIDAD) # logica Duhyadi jun 2024
# change to they way
sampled.states<-c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO", "SAN LUIS POTOSI",
"VERACRUZ DE IGNACIO DE LA LLAVE")
# not.sampled<-unique(mexico_sf$id)[!unique(mexico_sf$id) %in% sampled.states] # code original Alicia
not.sampled<-unique(mexico_sf$ENTIDAD)[!unique(mexico_sf$ENTIDAD) %in% sampled.states] #logica Duhyadi jun 2024
## Map showing only sampled states
map2 <- ggplot()  +
geom_polygon(data = mexico_sf,
aes(x = long, y = lat, group = group, fill =ENTIDAD ), #fill =id ),
colour = "grey") + theme_void() +
theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23)))# +
#  geom_polygon(data = distribution,
# aes(x = long, y = lat, group = group),
# colour = "blue", fill = NA) + theme_void()
map2
# mexico shape
mexico <- readOGR(dsn="destdv1gw", layer="destdv1gw")
library(dplyr)
library(ggplot2)
library(gpclib)
library(maptools)
library(rgeos)
library(rgdal)
# mexico shape
mexico <- readOGR(dsn="destdv1gw", layer="destdv1gw")
# olotillo, distribution shape
distribution <-readOGR(dsn="oloti_7cgw", layer="oloti_7cgw")
# olotillo, Proyecto Global Maíces Nativos (PGMN)
olotillo.PGMN <- read.csv("olotillo_PGMN_siagro.csv")
# olotillo, samples
olotillo.points <- read.csv("meta/olotillo_points_meta_clean.csv")
View(olotillo.points)
library(dplyr)
library(ggplot2)
library(gpclib)
library(maptools)
library(rgeos)
library(rgdal)
# mexico shape
mexico <- readOGR(dsn="destdv1gw", layer="destdv1gw")
# olotillo, distribution shape
distribution <-readOGR(dsn="oloti_7cgw", layer="oloti_7cgw")
# olotillo, Proyecto Global Maíces Nativos (PGMN)
olotillo.PGMN <- read.csv("olotillo_PGMN_siagro.csv")
# olotillo, samples
olotillo.points <- read.csv("meta/olotillo_points_meta_clean.csv")
View(olotillo.points)
library(dplyr)
library(ggplot2)
library(gpclib)
library(maptools)
library(rgeos)
library(rgdal)
# mexico shape
mexico <- readOGR(dsn="destdv1gw", layer="destdv1gw")
# olotillo, distribution shape
distribution <-readOGR(dsn="oloti_7cgw", layer="oloti_7cgw")
# olotillo, Proyecto Global Maíces Nativos (PGMN)
olotillo.PGMN <- read.csv("olotillo_PGMN_siagro.csv")
# olotillo, samples
olotillo.points <- read.csv("meta/olotillo_points_meta_clean.csv")
# shape file for mexico and potential distribution
map <- ggplot() +
geom_polygon(data = mexico, # shape-mexico
aes(x = long, y = lat, group = group),
colour = "grey", fill = NA) + theme_void() +
geom_polygon(data = distribution, size=0.2, # shape-distri.
aes(x = long, y = lat, group = group),
colour = "blue", fill = NA) + theme_void()
# shape file for olotillo, PGMN and and the collections for this study
map + geom_point(data = olotillo.PGMN, # points-olo.PGMN
size= 0.5, colour = "black",
aes(x=longitud, y=latitud)) +
geom_point(data = olotillo.points, size=1.5, # points-study
aes(x = longitude, y = latitude, shape= Race, color= Race)) +
scale_shape_manual(values = c(15, 17, 16, 18)) +
scale_color_manual(values = c("purple", "green", "red", "orange"))
# shape file for mexico and potential distribution
map <- ggplot() +
geom_polygon(data = mexico, # shape-mexico
aes(x = long, y = lat, group = group),
colour = "grey", fill = NA) + theme_void() +
geom_polygon(data = distribution, size=1, # shape-distri.
aes(x = long, y = lat, group = group),
colour = "purple", fill = NA) + theme_void()
# shape file for siagro and olotillo points
map + geom_point(data = olotillo.PGMN, # points-olo.PGMN
size= 0.5, colour = "black",
aes(x=longitud, y=latitud))
library(broom)
packageVersion("broom")
#install.packages("units")
library(sf)
mexico_sf <- st_as_sf(mexico, region = "ENTIDAD")
lapply(mexico_sf, class)
print(mexico_sf)
# transform shape to df
# broom package, convert statistical objects into Tidy Tibbles
mexico_df <- broom::tidy(mexico, region = "ENTIDAD")
# transform shape to df
# broom package, convert statistical objects into Tidy Tibbles
mexico_df <- broom::tidy(mexico, region = "ENTIDAD")
# read the file plate1_fullmeta.txt
pop.data <- read.table("meta/plate1_fullmeta.txt", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
# order alphabetically pop.data
pop.data <- pop.data[order(pop.data$sample_name),]
# remove the first element, (DNA BLANK)
pop.data <- pop.data[-1,]
# check n samples
dim(pop.data)
# read the file plate1_fullmeta.txt
pop.data <- read.table("meta/plate1_fullmeta.txt", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
# order alphabetically pop.data
pop.data <- pop.data[order(pop.data$sample_name),]
# remove the first element, (DNA BLANK)
pop.data <- pop.data[-1,]
# check n samples
dim(pop.data)
# make vector of states excluding where we sampled olotillos
sampled.states<-unique(pop.data$state)
sampled.states
# make vector of states excluding where we sampled olotillos
sampled.states<-unique(pop.data$state)
sampled.states
library(ggplot2)
# to get a names in the data frame
# unique(mexico_df$id) # code original Alicia
unique(mexico_sf$ENTIDAD) # logica Duhyadi jun 2024
# change to they way
sampled.states<-c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO", "SAN LUIS POTOSI",
"VERACRUZ DE IGNACIO DE LA LLAVE")
# not.sampled<-unique(mexico_sf$id)[!unique(mexico_sf$id) %in% sampled.states] # code original Alicia
not.sampled<-unique(mexico_sf$ENTIDAD)[!unique(mexico_sf$ENTIDAD) %in% sampled.states] #logica Duhyadi jun 2024
## Map showing only sampled states
map2 <- ggplot()  +
geom_polygon(data = mexico_sf,
aes(x = long, y = lat, group = group, fill =ENTIDAD ), #fill =id ),
colour = "grey") + theme_void() +
theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23)))# +
#  geom_polygon(data = distribution,
# aes(x = long, y = lat, group = group),
# colour = "blue", fill = NA) + theme_void()
map2
map3 <- ggplot() +
geom_polygon(data = mexico_df, show.legend=FALSE,
aes(x = long, y = lat, group = group, fill =id ),
colour = "grey") +
# theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23))) + theme_void()
# read the file plate1_fullmeta.txt
pop.data <- read.table("meta/plate1_fullmeta.txt", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
# order alphabetically pop.data
pop.data <- pop.data[order(pop.data$sample_name),]
# remove the first element, (DNA BLANK)
pop.data <- pop.data[-1,]
# check n samples
dim(pop.data)
# transform shape to df
# broom package, convert statistical objects into Tidy Tibbles
mexico_df <- broom::tidy(mexico, region = "ENTIDAD")
# make vector of states excluding where we sampled olotillos
sampled.states<-unique(pop.data$state)
sampled.states
library(ggplot2)
# to get a names in the data frame
# unique(mexico_df$id) # code original Alicia
unique(mexico_sf$ENTIDAD) # logica Duhyadi jun 2024
# change to they way
sampled.states<-c("CAMPECHE", "CHIAPAS", "GUERRERO", "HIDALGO",
"NAYARIT", "OAXACA", "QUINTANA ROO", "SAN LUIS POTOSI",
"VERACRUZ DE IGNACIO DE LA LLAVE")
# not.sampled<-unique(mexico_sf$id)[!unique(mexico_sf$id) %in% sampled.states] # code original Alicia
not.sampled<-unique(mexico_sf$ENTIDAD)[!unique(mexico_sf$ENTIDAD) %in% sampled.states] #logica Duhyadi jun 2024
## Map showing only sampled states
map2 <- ggplot()  +
geom_polygon(data = mexico_sf,
aes(x = long, y = lat, group = group, fill =ENTIDAD ), #fill =id ),
colour = "grey") + theme_void() +
theme(legend.position="none") +
scale_fill_manual(breaks = c(sampled.states, not.sampled),
values = c("grey60", # 9 color-blind friendly cols
"#75a842",
"#36dee6",
"#52bd85",
"#b94656",
"#6780d8",
"#c69c39",
"#b6b638",
"#89863c",
# the rest leave blank
rep("white", 23)))# +
#  geom_polygon(data = distribution,
# aes(x = long, y = lat, group = group),
# colour = "blue", fill = NA) + theme_void()
map2
